<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
   <style>
  .riga-evidenziata {
    background-color: yellow; 
    transition: background-color 0.3s;
  }
</style>
</head>
 <script>
        function creaEl(){
            var nome=document.getElementById("id1").value;
            var pf=document.getElementById("id2").value;
            var roll=document.getElementById("id3").value;
            var ca=document.getElementById("id4").value;
            var tabella=document.getElementById("tabella").getElementsByTagName('tbody')[0];
            var rigaagg=tabella.insertRow();
            var nomeagg=rigaagg.insertCell(0);
            nomeagg.textContent=nome;
            var pfagg=rigaagg.insertCell(1);
            pfagg.setAttribute("id","pf");
            pfagg.textContent=pf;
            var rollagg=rigaagg.insertCell(2);
            rollagg.textContent=roll;
            rollagg.setAttribute("class","roll");
            caagg=rigaagg.insertCell(3);
            caagg.textContent=ca;
            var funz=rigaagg.insertCell(4);
            var elem=document.createElement('input');
             elem.setAttribute('input','number');
             elem.setAttribute('class','inputvita');
             funz.appendChild(elem);
            var elem1=document.createElement('Button');
            elem1.textContent="Calcola";
            elem1.setAttribute('onclick','sottrai(this)');
            funz.appendChild(elem1);}

        function sottrai(input){
            var riga=input.closest('tr');
            var cella=riga.querySelector('#pf');
            cella2=cella.textContent;
            var valdasott=riga.querySelector(".inputvita").value;
            var cella2=parseInt(cella2);
           if(isNaN(cella2)){return;}
            var val=parseInt(valdasott);
            var calcolata=cella2+val;
            if(calcolata>=0){
            cella.textContent=calcolata;}
            else{
                cella.textContent=0;
            }
        }

        function ordina(){
            var lista=document.querySelectorAll("tbody tr");
            var array=Array.from(lista);
            array.sort(function(rigaA,rigaB){
                var testoA=rigaA.querySelector(".roll").textContent;
                var testoB=rigaB.querySelector(".roll").textContent;
                var valoreA=parseInt(testoA);
                var valoreB=parseInt(testoB);
                return valoreB-valoreA;
            });
            var corpotab=document.querySelector("tbody");
            array.forEach(function(riga){
                corpotab.append(riga);
            })
        }
        let indiceRigaAttuale = -1; 

function segnaturno() {
    const righe = document.querySelectorAll('tbody tr');
    if (righe.length === 0) return; 
    if (indiceRigaAttuale >= 0 && indiceRigaAttuale < righe.length) {
        righe[indiceRigaAttuale].classList.remove('riga-evidenziata');
    }

    indiceRigaAttuale++;
    if (indiceRigaAttuale >= righe.length) {
        indiceRigaAttuale = 0;
    }

    righe[indiceRigaAttuale].classList.add('riga-evidenziata');
}
    </script>
<body>
    <h1>Benvenuti nel contacazzi</h1>
    <a href="tutorial.html" >Per il tutorial sui file json/csv clicca qui</a><br>
    <p>Se si volesse registrare un personaggio inserire / o un carattere a caso nei pf o nella CA</p>
    <a>Inserisci nome creatura:</a><input type="text" id="id1"></input><br>
    <a>Inserisci punti ferita:</a><input type="text" id="id2"></input><br>
    <a>Inserisci Iniziativa</a><input type="number" id="id3"></input><br>
     <a>Inserisci Armor class(CA)</a><input type="number" id="id4"></input><br>
    <button onclick="creaEl()">Crea nuovo</button><button onclick="ordina()">Ordina per Iniziativa</button><button onclick="segnaturno()">Progredisci Turno</button><br>
        
        <table border="1px" id="tabella">
            <thead>
        <tr>
            <th>Nome Creatura</th>
            <th>Punti Ferita</th>
            <th>Roll Iniziativa</th>
            <th>CA</th>
            <th>Modifica PF</th>
        </tr>
        </thead>
        <tbody></tbody>
        
        </table>
</body>

</html>
